// Generated by CoffeeScript 1.6.3
var packages, scrape;

scrape = require('scrape');

packages = function(user) {
  var api, getUrl, request, resolve;
  api = 'https://npmjs.org/browse/author/:user';
  request = function(url, total, page) {
    if (total == null) {
      total = 0;
    }
    if (page == null) {
      page = 0;
    }
    return scrape.request("" + url + "/" + page, function(err, $) {
      var count, rows;
      rows = $('#package .row');
      count = rows.length;
      if (count > 1) {
        total += count;
        return request(url, total, ++page);
      } else {
        return resolve(total);
      }
    });
  };
  getUrl = function(user) {
    return api.replace(':user', user);
  };
  resolve = function(count) {
    return console.log(count);
  };
  return request(getUrl(user));
};

packages('isaacs');
